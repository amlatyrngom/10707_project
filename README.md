# Object detection model

## 1. Generating the training data
The training was removed to reduce the size of the folder, so make sure to download the Flickr8k dataset and place it in the current directory.
. The training features can then be generated by executing the following code.

```sh
# Generate image features
python prep_img.py
# Generate caption features
python prep_txt.py
# Generate the tokenizer
python gen_tokenizer.py

# Generate object detection data
# First cd into the detection library
cd PyTorch-YOLOv3
# Generate pickle files containing the data
python gen_caption_data.py --gen_data train --image_folder <path_to_flicker_images>
# Move them to the main directory
mv *.pkl ..
cd ..
```

## 2. Training
Simply run
```sh
python train.py
```
The models will then be saved into the **models/** folder.
## 3. Getting BLEU scores
```sh
python eval.py <path_to_best_model>
```

## 4. Generating caption
```sh
# Generate pickle files containing the test caption
cd PyTorch-YOLOv3
python gen_caption_data.py --gen_data test --image_folder <path_to_test_image_folder>
mv *.pkl ..
cd ..

python gen_caption.py <path_to_test_image>
```
